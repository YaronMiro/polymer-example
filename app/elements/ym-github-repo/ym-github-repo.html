<dom-module id="ym-github-repo">
  <style>
    :host {
      display: block;
    }

    .github-repo-wrapper {
      border-radius: 3px;
      padding: 8px;
      border: 1px solid rgba(128, 128, 128, 0.74);
    }

    .info {
      list-style-type: none;
      padding: 0px;
    }

    .info li {

    }

    iron-image {
      width:100px;
      height:100px
    }

    .image {
      display: inline-block;
      padding: 8px;
      border: 1px solid rgba(128, 128, 128, 0.74);
    }

    code {
      border-radius: 3px;
      display: inline-block;
      padding: 10px;
      background: rgb(243, 243, 243);
    }


    input {
      width: 100%;
    }

  </style>
  <template>

    <div class="github-repo-wrapper">
      <!-- Two-way binding for "<input>.value" -->
      <paper-input label="Owner" class="paper-font-body2" value="{{owner}}"></paper-input>
      <paper-input label="Name" class="paper-font-body2" value="{{name}}"></paper-input>
      <!-- Search button -->
      <paper-button gray-ripple> <iron-icon icon="icons:search"></iron-icon> Search</paper-button>

      <paper-fab mini icon="favorite"></paper-fab>

      <p>Search url</p>
      <p>
        <code>
          <span>{{url}}</span>
        </code>
      </p>
      <!-- Ajax call to Github API -->
      <!-- https://api.github.com/repos/YaronMiro/AngularJS-UI-Router-Demo -->
      <iron-ajax auto
                 id="ajax"
                 url="{{url}}"
                 handle-as="json"
                 on-response="onResponse"
                 on-error="onError"
                 last-response="{{ajax.response}}"></iron-ajax>

      <section>
        <div class="info-wrapper">
          <!-- Repo info -->
          <ul class="info">
            <li>
              <div>owner: </div>
              <a href="{{ajax.response.owner.url}}">{{ajax.response.owner.login}}</a>
            </li>
            <li class="image"><iron-image sizing="contain" src="{{ajax.response.owner.avatar_url}}"></iron-image></li>
            <li>
              <a href="{{ajax.response.html_url}}">{{ajax.response.name}}</a>
            </li>
            <li>Public repository</li>
            <li>Stars: <span>{{ajax.response.stargazers_count}}</span></li>
            <li></li>
          </ul>
        </div>
      </section>
    </div>
  </template>

  <script>
    (function() {

      Polymer({
        is: 'ym-github-repo',
        properties: {
          owner: {
            type: String,
            value: 'yaronMiro'
          },
          name: {
            type: String,
            value: 'AngularJS-UI-Router-Demo'
          },
          url: {
            type: String,
            computed: 'getUrl(owner, name)'
          },
          ajax: {
            type: Object,
            value: {
              response: {}
            }
          }
        },
        getUrl: function(owner, name) {
          return 'https://api.github.com/repos/' + owner + '/' + name;
        },
        onResponse: function(data, b) {
         console.log('From on-response', data);
         console.log('From on-response', b);
         console.log('From on-response', this.$);
        },
        onError: function(data, b) {
         console.log('From on-error', data);
          console.log('From on-response', b);
          console.log('From on-response', data);
        }
      });
    })();
  </script>

</dom-module>
