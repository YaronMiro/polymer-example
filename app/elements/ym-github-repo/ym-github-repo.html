<dom-module id="ym-github-repo">
  <style>
    :host {
      display: block;
    }

    input {
      width: 100%;
    }

  </style>
  <template>
    <span class="paper-font-body2">Fill the fields to get an info about the repository (only for public repositories)
    <br>
    <span>e.g: YaronMiro/AngularJS-UI-Router-Demo</span>
    </span>
    <!-- Listens for "input" event and sets the target repository to <input>.value -->
    <paper-input label="Owner" class="paper-font-body2" value="{{owner}}"></paper-input>
    <paper-input label="Name" class="paper-font-body2" value="{{name}}"></paper-input>
    <div>
      <span>{{ owner }}</span>/<span>{{ name }}</span>
    </div>
    <!-- Ajax call to Github API -->
    <!-- https://api.github.com/repos/YaronMiro/AngularJS-UI-Router-Demo -->
    <iron-ajax auto
        id="ajax"
        url="{{url}}"
        handle-as="json"
        on-response="onResponse"
        on-error="onError"
        last-response="{{ajax.response}}"></iron-ajax>

    <section>
      <div class="info-wrapper">
        <a href="{{ajax.response.html_url}}">{{ajax.response.full_name}}</a>
        <iron-image style="width:100px; height:100px;" sizing="contain" src="{{ajax.response.owner.avatar_url}}"></iron-image>
      </div>
    </section>
  </template>

  <script>
    (function() {

      Polymer({
        is: 'ym-github-repo',
        properties: {
          owner: {
            type: String,
            value: 'yaronMiro'
          },
          name: {
            type: String,
            value: 'AngularJS-UI-Router-Demo'
          },
          url: {
            type: String,
            computed: 'getUrl(owner, name)'
          },
          ajax: {
            type: Object,
            value: {
              error: {},
              response: {}
            }
          }
        },
        getUrl: function(owner, name) {
          return 'https://api.github.com/repos/' + owner + '/' + name;
        },
        onResponse: function(data, b) {
         console.log('From on-response', data);
         console.log('From on-response', b);
         console.log('From on-response', this.$);
        },
        onError: function(data, b) {
         console.log('From on-error', data);
          console.log('From on-response', b);
          console.log('From on-response', data);
        }
      });
    })();
  </script>

</dom-module>
